!function(e){"use strict";function t(){return e.AudioContext=e.AudioContext||e.webkitAudioContext||e.mozAudioContext,e.AudioContext?new e.AudioContext:void alert("Sorry bro. Your browser does not provide Audio API support.")}function n(){return e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame,e.requestAnimationFrame?e.requestAnimationFrame:void alert("Seriously bro. Take a modern web broswer, thank you.")}function o(){var e=new XMLHttpRequest;e.open("GET",A,!0),e.responseType="arraybuffer",e.onload=function(){s(".spinner")},e.onreadystatechange=function(){4===e.readyState&&200===e.status&&w.decodeAudioData(e.response,function(e){s(".spinner"),a(e)},r)},e.send()}function r(e){console.log(e)}function i(){m||(m=w.createBufferSource(),h=w.createAnalyser(),g=w.createAnalyser(),v=w.createScriptProcessor(),p=w.createChannelSplitter(),y=w.createGain())}function a(e){m.buffer=e,v.connect(w.destination),h.smootingTimeConstant=C,h.fftSize=q,g.smootingTimeConstant=C,g.fftSize=q,m.connect(p),p.connect(h,0,0),p.connect(g,1,0),h.connect(v),m.connect(y),y.gain.value=.5,y.connect(w.destination),m.start(0),v.onaudioprocess=function(){var e,t,n,o;e=new Uint8Array(h.frequencyBinCount),h.getByteFrequencyData(e),t=new Uint8Array(g.frequencyBinCount),g.getByteFrequencyData(t),n=u(e,b),o=u(t,b),d(n,o)}}function u(e,t){var n=new Array(t),o=0,r=0,i=0,a=Math.floor(e.length/t);for(r=0;t>r;r++){for(n[r]=1,i=0===r?1*a:a*r,o=0;a>o;o++)n[r]+=e[i+o];n[r]=n[r]/a}return n}function c(e){y.gain.value=e}function d(t,o){var r=document.getElementById("beat"),i=0,a=t.length-1,u=21.25,c=28.75,s=!1,l=r.getContext("2d");for(r.width=e.innerWidth,r.height=300,l.strokeStyle=setTimeout(f(),3e3),l.lineWidth=4,l.lineJoin="miter",l.clearRect(0,0,r.width,r.height),l.beginPath(),l.moveTo(0,r.height/2),l.lineTo(12,r.height/2),i=0;i<Math.round(r.width/26);i++)0===a?s=!0:a===t.length-1&&(s=!1),s===!1?a--:a++,l.quadraticCurveTo(u,150+-1*o[a],c,r.height/2),u+=12.5,c+=11.25,l.quadraticCurveTo(u,150+1*t[a],c,r.height/2),u+=12.5,c+=13.75;l.lineTo(r.width-20,r.height/2),l.stroke(),n(d)}function s(e){var t=document.querySelector(e);t.classList.toggle("spinner-hide")}function l(t){var n,o,r,i;return r=document.getElementById(t),o=new FileReader,n=r.files[0],"audio/mpeg"===n.type||"audio/mp3"===n.type?i=e.URL.createObjectURL(n):!1}function f(){return"#"+Math.floor(16777215*Math.random()).toString(16)}var m,h,g,y,v,p,A,w=new t,q=256,C=.5,b=14,S=document.getElementById("file"),T=document.getElementById("volume-control"),B=document.getElementById("waves-control");S.addEventListener("change",function(e){e.preventDefault(),A=l("file"),A!==!1?(i(),o(A)):alert("Only mp3 bro. Select another file")}),T.addEventListener("change",function(e){e.preventDefault(),c(T.value)},!1),B.addEventListener("change",function(e){e.preventDefault(),b=this.value})}(window);